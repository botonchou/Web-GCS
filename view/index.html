<!DOCTYPE>
<html>
  <head>
    <link rel="stylesheet" href="vendor/bootstrap-3.2.0-dist/css/bootstrap.min.css">
    <script src="js/jquery-2.1.1.min.js"></script>
    <script src="js/md5.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <style>
      #msg-to-drone {
	display: inline;
	width: 55%;
      } 

      #btn-send {
	width: 33%;
      }

      #panel-bottom {
	position: fixed;
	bottom: 5px;
	left: 5%;
	right: 0;
	width: 100%;
      }
    </style>

    <script>
      
      var socket;
      $(function () {
	document.addEventListener("touchstart", function(){}, true);

	$("#btn-send").click(function () {
	  var msg = $('#msg-to-drone').val();
	  send(msg);
	});

	var $armCtrl = $("#drone-arm-disarm");
	$armCtrl.click(function () {
	  if ($armCtrl.text() == "ARM") {
	    send("ARM");
	    $armCtrl.toggleClass("btn-warning").toggleClass("btn-danger");
	    $armCtrl.text("DISARM");
	  }
	  else {
	    send("DISARM");
	    $armCtrl.toggleClass("btn-warning").toggleClass("btn-danger");
	    $armCtrl.text("ARM");
	  }
	});

	socket = io();
	socket.on('message', function (timestamp, msg, md5sum) {
	  console.log(msg);
	});
      });

      function send(msg) {
	if (msg.length == 0)
	  return

	var timestamp = new Date().getTime();
	socket.emit('message', timestamp, msg, md5(timestamp + msg) );
      }

    </script>
  </head>
  <body>
    <div class="container">
      <form class="form-horizontal" role="form">
	<br/>
	<button id='drone-arm-disarm' type="button" class="btn btn-danger btn-lg">ARM</button>
	<br/>
	<div id="panel-bottom">
	  <div class="form-group form-group-lg">
	    <input id='msg-to-drone' type="text" class="form-control" placeholder="Message to drone">
	    <button id='btn-send' type="button" class="btn btn-default btn-lg">Send</button>
	  </div>
	</div>
      </form>
    </div>
  </body>
</html>
